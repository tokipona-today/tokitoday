<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Introduction to MQTTI recently picked up an ESP32-S3 with a built-in touchscreen — a sleek little board that instantly sparked an idea: what if every member of our APEX team at UniLaSalle Beauvais had">
<meta property="og:type" content="article">
<meta property="og:title" content="MQTT Concepts for Iot project">
<meta property="og:url" content="http://tokipona.today/2025/05/24/MQTT/index.html">
<meta property="og:site_name" content="toki pona today!">
<meta property="og:description" content="Introduction to MQTTI recently picked up an ESP32-S3 with a built-in touchscreen — a sleek little board that instantly sparked an idea: what if every member of our APEX team at UniLaSalle Beauvais had">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-05-24T04:23:32.000Z">
<meta property="article:modified_time" content="2025-05-24T10:04:56.401Z">
<meta property="article:author" content="jan Pitaki">
<meta property="article:tag" content="other">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>MQTT Concepts for Iot project</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="toki pona today!" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<style type="text/css">
.spoiler {
  display: inline-flex;
}
p.spoiler {
  display: flex;
}
.spoiler a {
  pointer-events: none;
}
.spoiler-blur, .spoiler-blur > * {
  transition: text-shadow .5s ease;
}
.spoiler .spoiler-blur, .spoiler .spoiler-blur > * {
  color: rgba(0, 0, 0, 0);
  background-color: rgba(0, 0, 0, 0);
  text-shadow: 0 0 10px grey;
  cursor: pointer;
}
.spoiler .spoiler-blur:hover, .spoiler .spoiler-blur:hover > * {
  text-shadow: 0 0 5px grey;
}
.spoiler-box, .spoiler-box > * {
  transition: color .5s ease,
  background-color .5s ease;
}
.spoiler .spoiler-box, .spoiler .spoiler-box > * {
  color: black;
  background-color: black;
  text-shadow: none;
}</style><meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    <div class="content index py4">
        <header id="header">
  <a href="/">
  
    
      <div id="logo" style="background-image: url(/images/logo.png);"></div>
    
  
    <div id="title">
      <h1>toki pona today!</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/tags/lesson">Lessons</a></li>
      
        <li><a href="/tags/practice">practice</a></li>
      
        <li><a href="/tags/blog">blog</a></li>
      
        <li><a href="/tags/other">other</a></li>
      
        <li><a target="_blank" rel="noopener" href="http://tokipona.org">links</a></li>
      
        <li><a href="/About/">About</a></li>
      
    </ul>
  </div>
</header>

        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        MQTT Concepts for Iot project
    </h1>


    <div class="meta">
    

      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/other/" rel="tag">other</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Introduction-to-MQTT"><a href="#Introduction-to-MQTT" class="headerlink" title="Introduction to MQTT"></a>Introduction to MQTT</h2><p>I recently picked up an ESP32-S3 with a built-in touchscreen — a sleek little board that instantly sparked an idea: what if every member of our APEX team at UniLaSalle Beauvais had their own personal, pocket-sized device to send and receive quick updates? Something tactile, fun, and a bit futuristic. Think messages like “Lunch in 10 minutes” or “Meet in the APEX room” — sent with a tap and confirmed by a subtle vibration.</p>
<p>I didn’t want to rely on rigid enterprise tools like Teams or platforms buried behind logins and firewalls. I wanted a fast, local, flexible network that we could fully control. A way to communicate instantly and privately — something built for us.</p>
<p>That’s where MQTT came in. This unassuming little protocol turned out to be the perfect backbone: lightweight, real-time, and rock solid. It made the system feel less like engineering and more like crafting a tool with personality.</p>
<p>This guide walks through how we built it — from setting up the broker to sending your first message. Whether you’re building something similar or just exploring how to get embedded devices talking simply and efficiently, you’ll find practical tips and working examples to get started.</p>
<h3 id="Core-Terminology"><a href="#Core-Terminology" class="headerlink" title="Core Terminology"></a>Core Terminology</h3><ul>
<li><p><strong>Broker</strong>: The centralized server that handles all message routing between clients.</p>
</li>
<li><p><strong>Client</strong>: Any device or application that publishes or subscribes to messages.</p>
</li>
<li><p><strong>Topic</strong>: A UTF-8 string used to route messages logically. Hierarchically structured (e.g., <code>region/device/status</code>).</p>
</li>
<li><p><strong>Payload</strong>: The message content, often JSON or binary.</p>
</li>
<li><p><strong>QoS (Quality of Service)</strong>: Defines message delivery guarantees:</p>
<ul>
<li>0: At most once (fire and forget)</li>
<li>1: At least once</li>
<li>2: Exactly once</li>
</ul>
</li>
<li><p><strong>Retained Message</strong>: A last-known-good message that persists on a topic for late subscribers.</p>
</li>
</ul>
<hr>
<h2 id="Installing-and-Configuring-the-MQTT-Broker"><a href="#Installing-and-Configuring-the-MQTT-Broker" class="headerlink" title="Installing and Configuring the MQTT Broker"></a>Installing and Configuring the MQTT Broker</h2><p>MQTT brokers like Mosquitto are available on all major platforms. Here’s how to get started depending on your OS:</p>
<h3 id="Installing-Mosquitto-on-Linux"><a href="#Installing-Mosquitto-on-Linux" class="headerlink" title="Installing Mosquitto on Linux"></a>Installing Mosquitto on Linux</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install mosquitto mosquitto-clients</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> mosquitto</span><br><span class="line">sudo systemctl start mosquitto</span><br></pre></td></tr></table></figure>

<h3 id="Testing-the-Broker"><a href="#Testing-the-Broker" class="headerlink" title="Testing the Broker"></a>Testing the Broker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Subscriber terminal</span></span><br><span class="line">tmux new-session -d -s mqtttest <span class="string">&#x27;mosquitto_sub -h localhost -t diagnostics/test&#x27;</span></span><br><span class="line"><span class="comment"># Publisher terminal</span></span><br><span class="line">mosquitto_pub -h localhost -t diagnostics/<span class="built_in">test</span> -m <span class="string">&quot;Test message&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Installing-on-macOS"><a href="#Installing-on-macOS" class="headerlink" title="Installing on macOS"></a>Installing on macOS</h3><p>Using Homebrew:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install mosquitto</span><br><span class="line">brew services start mosquitto</span><br></pre></td></tr></table></figure>

<p>You may need to allow Mosquitto through your firewall in <strong>System Preferences &gt; Security &amp; Privacy</strong>.</p>
<h3 id="Installing-on-Windows"><a href="#Installing-on-Windows" class="headerlink" title="Installing on Windows"></a>Installing on Windows</h3><ol>
<li>Download Mosquitto from the <a target="_blank" rel="noopener" href="https://mosquitto.org/download/">official site</a>.</li>
<li>Run the installer and ensure to install the <strong>service</strong> and <strong>CLI tools</strong>.</li>
<li>Start the broker via PowerShell:</li>
</ol>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Start-Service</span> mosquitto</span><br></pre></td></tr></table></figure>

<p>Or run it manually:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;C:\Program Files\mosquitto\mosquitto.exe&quot;</span> <span class="literal">-v</span></span><br></pre></td></tr></table></figure>

<h3 id="Using-a-Public-Broker-for-Development"><a href="#Using-a-Public-Broker-for-Development" class="headerlink" title="Using a Public Broker (for Development)"></a>Using a Public Broker (for Development)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_sub -h test.mosquitto.org -t testing/session</span><br><span class="line">mosquitto_pub -h test.mosquitto.org -t testing/session -m <span class="string">&quot;Public test message&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>⚠️ Use public brokers only for prototyping or testing. They are not secured and offer no guarantees of message integrity or availability.</p>
</blockquote>
<hr>
<h2 id="Connecting-ESP32-Using-Arduino-Framework"><a href="#Connecting-ESP32-Using-Arduino-Framework" class="headerlink" title="Connecting ESP32 Using Arduino Framework"></a>Connecting ESP32 Using Arduino Framework</h2><h3 id="Required-Libraries"><a href="#Required-Libraries" class="headerlink" title="Required Libraries"></a>Required Libraries</h3><ul>
<li>PubSubClient (via Arduino Library Manager)</li>
</ul>
<h3 id="Minimal-Implementation"><a href="#Minimal-Implementation" class="headerlink" title="Minimal Implementation"></a>Minimal Implementation</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;WiFi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;PubSubClient.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">WiFiClient espClient;</span><br><span class="line"><span class="function">PubSubClient <span class="title">client</span><span class="params">(espClient)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callback</span><span class="params">(<span class="keyword">char</span>* topic, byte* payload, <span class="keyword">unsigned</span> <span class="keyword">int</span> length)</span> </span>&#123;</span><br><span class="line">  Serial.<span class="built_in">printf</span>(<span class="string">&quot;Message received on topic %s: &quot;</span>, topic);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) Serial.<span class="built_in">print</span>((<span class="keyword">char</span>)payload[i]);</span><br><span class="line">  Serial.<span class="built_in">println</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">connectMQTT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (!client.<span class="built_in">connected</span>()) &#123;</span><br><span class="line">    client.<span class="built_in">connect</span>(<span class="string">&quot;esp32_unit1&quot;</span>);</span><br><span class="line">    client.<span class="built_in">subscribe</span>(<span class="string">&quot;iot/devices/esp32_unit1/commands&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  WiFi.<span class="built_in">begin</span>(<span class="string">&quot;SSID&quot;</span>, <span class="string">&quot;PASSWORD&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> (WiFi.<span class="built_in">status</span>() != WL_CONNECTED) <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">  client.<span class="built_in">setServer</span>(<span class="string">&quot;192.168.1.100&quot;</span>, <span class="number">1883</span>);</span><br><span class="line">  client.<span class="built_in">setCallback</span>(callback);</span><br><span class="line">  <span class="built_in">connectMQTT</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!client.<span class="built_in">connected</span>()) <span class="built_in">connectMQTT</span>();</span><br><span class="line">  client.<span class="built_in">loop</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Publishing-a-Status-Update"><a href="#Publishing-a-Status-Update" class="headerlink" title="Publishing a Status Update"></a>Publishing a Status Update</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client.<span class="built_in">publish</span>(<span class="string">&quot;iot/devices/esp32_unit1/status&quot;</span>, <span class="string">&quot;Device online&quot;</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>🛠 Consider adding retry logic, watchdog timers, and exponential backoff for production deployments.</p>
</blockquote>
<hr>
<h2 id="Topic-Structure-and-Naming-Conventions"><a href="#Topic-Structure-and-Naming-Conventions" class="headerlink" title="Topic Structure and Naming Conventions"></a>Topic Structure and Naming Conventions</h2><p>A robust topic naming scheme is essential for scalability and maintainability. Topics should be predictable, structured, and semantically meaningful.</p>
<h3 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h3><ul>
<li>Use slash-separated paths: <code>building/room1/temp</code></li>
<li>Avoid dynamic or user-generated topic names</li>
<li>Stick to lowercase and avoid special characters</li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><ul>
<li><code>system/monitor/battery</code></li>
<li><code>alerts/security/fire</code></li>
<li><code>devices/device42/uptime</code></li>
</ul>
<h3 id="Wildcards"><a href="#Wildcards" class="headerlink" title="Wildcards"></a>Wildcards</h3><ul>
<li><code>devices/+/status</code> matches all device status messages</li>
<li><code>alerts/#</code> captures all nested alert messages</li>
</ul>
<hr>
<h2 id="Debugging-and-Tooling"><a href="#Debugging-and-Tooling" class="headerlink" title="Debugging and Tooling"></a>Debugging and Tooling</h2><h3 id="GUI-MQTT-Explorer"><a href="#GUI-MQTT-Explorer" class="headerlink" title="GUI: MQTT Explorer"></a>GUI: MQTT Explorer</h3><ul>
<li>A desktop application for browsing topics and messages.</li>
<li><a target="_blank" rel="noopener" href="https://mqtt-explorer.com/">https://mqtt-explorer.com</a></li>
</ul>
<h3 id="CLI-Tools"><a href="#CLI-Tools" class="headerlink" title="CLI Tools"></a>CLI Tools</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_sub -h localhost -t <span class="string">&#x27;#&#x27;</span></span><br><span class="line">mosquitto_pub -h localhost -t system/health -m <span class="string">&quot;OK&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Example-Use-Cases-and-Testing-Scenarios"><a href="#Example-Use-Cases-and-Testing-Scenarios" class="headerlink" title="Example Use Cases and Testing Scenarios"></a>Example Use Cases and Testing Scenarios</h2><h3 id="Device-to-Device-Messaging"><a href="#Device-to-Device-Messaging" class="headerlink" title="Device-to-Device Messaging"></a>Device-to-Device Messaging</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client.<span class="built_in">publish</span>(<span class="string">&quot;devices/esp32a/to_esp32b&quot;</span>, <span class="string">&quot;Ping&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client.<span class="built_in">subscribe</span>(<span class="string">&quot;devices/esp32a/to_esp32b&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Environmental-Sensing"><a href="#Environmental-Sensing" class="headerlink" title="Environmental Sensing"></a>Environmental Sensing</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client.<span class="built_in">publish</span>(<span class="string">&quot;sensors/lab1/temp&quot;</span>, <span class="string">&quot;22.8C&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Emergency-Notification"><a href="#Emergency-Notification" class="headerlink" title="Emergency Notification"></a>Emergency Notification</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client.<span class="built_in">publish</span>(<span class="string">&quot;alerts/fire/lab1&quot;</span>, <span class="string">&quot;Evacuate now&quot;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Local-Fleet-Communication-with-ESP32"><a href="#Local-Fleet-Communication-with-ESP32" class="headerlink" title="Local Fleet Communication with ESP32"></a>Local Fleet Communication with ESP32</h2><h3 id="Architecture-Diagram-ASCII"><a href="#Architecture-Diagram-ASCII" class="headerlink" title="Architecture Diagram (ASCII)"></a>Architecture Diagram (ASCII)</h3><p>Here’s a simplified overview of how our MQTT-based communication system is structured:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------+</span><br><span class="line">|     PC (Dev Machine)     |</span><br><span class="line">|---------------------------|</span><br><span class="line">| CLI Tools (pub/sub)      |</span><br><span class="line">| MQTT Broker (Mosquitto)  |</span><br><span class="line">+-----------+---------------+</span><br><span class="line">            |</span><br><span class="line">            | Wi-Fi (LAN)</span><br><span class="line">            v</span><br><span class="line">+-----------+-------------------+       +---------------------+</span><br><span class="line">|      ESP32 Device #1         |&lt;-----&gt;|   ESP32 Device #2    |</span><br><span class="line">|------------------------------|       |----------------------|</span><br><span class="line">| Subscribed to: apex/device1 |       | Subscribed to: apex/device2 |</span><br><span class="line">| and: apex/broadcast          |       | and: apex/broadcast       |</span><br><span class="line">+------------------------------+       +---------------------+</span><br><span class="line">            |</span><br><span class="line">            | Wi-Fi (LAN)</span><br><span class="line">            v</span><br><span class="line">     +----------------------------+</span><br><span class="line">     |       ESP32 Device #N      |</span><br><span class="line">     | Subscribed to: apex/deviceN|</span><br><span class="line">     | and: apex/broadcast        |</span><br><span class="line">     +----------------------------+</span><br></pre></td></tr></table></figure>

<p>This setup ensures all devices can receive targeted messages as well as group announcements. Each ESP32 connects to the same broker and listens to both its own channel and a common one for broadcasts.</p>
<p>In our APEX project setup, we’re not connecting to Microsoft Teams or any external cloud platform. Instead, we’re using a <strong>local MQTT broker</strong> on a PC or Raspberry Pi, and a fleet of ESP32s as both message publishers and subscribers. Messages are exchanged over the local network without relying on the internet — fast, private, and under full control.</p>
<p>During development and testing, we interact with the system directly from a <strong>PC using CLI tools</strong>. This allows us to simulate any ESP32 device and verify communication without flashing firmware repeatedly.</p>
<h3 id="Example-Send-a-Message-from-the-PC"><a href="#Example-Send-a-Message-from-the-PC" class="headerlink" title="Example: Send a Message from the PC"></a>Example: Send a Message from the PC</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_pub -h localhost -t apex/chloe -m <span class="string">&quot;Meeting in APEX room&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Example-Listen-to-Incoming-Messages"><a href="#Example-Listen-to-Incoming-Messages" class="headerlink" title="Example: Listen to Incoming Messages"></a>Example: Listen to Incoming Messages</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_sub -h localhost -t apex/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>This design enables one device (or a user on a PC) to message any subset of ESP32 devices through named topics like <code>apex/david</code>, <code>apex/broadcast</code>, or <code>alerts/urgent</code>. Each ESP32 subscribes to its own topic and a shared one for global announcements.</p>
<h2 id="Usual-Boring-Security-Considerations"><a href="#Usual-Boring-Security-Considerations" class="headerlink" title="Usual Boring Security Considerations"></a>Usual Boring Security Considerations</h2><ul>
<li>Use authentication (username/password) and TLS encryption</li>
<li>Isolate environments (development, staging, production)</li>
<li>Avoid hardcoded secrets in firmware</li>
<li>Use access control lists (ACLs) to limit topic access</li>
<li>Monitor broker uptime and message throughput</li>
</ul>
<hr>
<h1 id="Conclusion-and-Future-Work"><a href="#Conclusion-and-Future-Work" class="headerlink" title="Conclusion and Future Work"></a>Conclusion and Future Work</h1><p>MQTT offers an elegant, low-overhead messaging model ideal for real-time, event-driven embedded systems. With its publish/subscribe architecture, extensibility, and lightweight footprint, it is particularly well suited for ESP32-based networks.</p>
<p>In future articles, we may explore advanced capabilities such as retained messages, last will/testament, bridging across MQTT brokers, MQTT over WebSockets, and integration with cellular IoT backends.</p>
<p>Feedback, contributions, and topic suggestions are always welcome.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/tags/lesson">Lessons</a></li>
        
          <li><a href="/tags/practice">practice</a></li>
        
          <li><a href="/tags/blog">blog</a></li>
        
          <li><a href="/tags/other">other</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://tokipona.org">links</a></li>
        
          <li><a href="/About/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction-to-MQTT"><span class="toc-number">1.</span> <span class="toc-text">Introduction to MQTT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Core-Terminology"><span class="toc-number">1.1.</span> <span class="toc-text">Core Terminology</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing-and-Configuring-the-MQTT-Broker"><span class="toc-number">2.</span> <span class="toc-text">Installing and Configuring the MQTT Broker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-Mosquitto-on-Linux"><span class="toc-number">2.1.</span> <span class="toc-text">Installing Mosquitto on Linux</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Testing-the-Broker"><span class="toc-number">2.2.</span> <span class="toc-text">Testing the Broker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-on-macOS"><span class="toc-number">2.3.</span> <span class="toc-text">Installing on macOS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-on-Windows"><span class="toc-number">2.4.</span> <span class="toc-text">Installing on Windows</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-a-Public-Broker-for-Development"><span class="toc-number">2.5.</span> <span class="toc-text">Using a Public Broker (for Development)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Connecting-ESP32-Using-Arduino-Framework"><span class="toc-number">3.</span> <span class="toc-text">Connecting ESP32 Using Arduino Framework</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Required-Libraries"><span class="toc-number">3.1.</span> <span class="toc-text">Required Libraries</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Minimal-Implementation"><span class="toc-number">3.2.</span> <span class="toc-text">Minimal Implementation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Publishing-a-Status-Update"><span class="toc-number">3.3.</span> <span class="toc-text">Publishing a Status Update</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-Structure-and-Naming-Conventions"><span class="toc-number">4.</span> <span class="toc-text">Topic Structure and Naming Conventions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Best-Practices"><span class="toc-number">4.1.</span> <span class="toc-text">Best Practices</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Examples"><span class="toc-number">4.2.</span> <span class="toc-text">Examples</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wildcards"><span class="toc-number">4.3.</span> <span class="toc-text">Wildcards</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Debugging-and-Tooling"><span class="toc-number">5.</span> <span class="toc-text">Debugging and Tooling</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GUI-MQTT-Explorer"><span class="toc-number">5.1.</span> <span class="toc-text">GUI: MQTT Explorer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CLI-Tools"><span class="toc-number">5.2.</span> <span class="toc-text">CLI Tools</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-Use-Cases-and-Testing-Scenarios"><span class="toc-number">6.</span> <span class="toc-text">Example Use Cases and Testing Scenarios</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Device-to-Device-Messaging"><span class="toc-number">6.1.</span> <span class="toc-text">Device-to-Device Messaging</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Environmental-Sensing"><span class="toc-number">6.2.</span> <span class="toc-text">Environmental Sensing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Emergency-Notification"><span class="toc-number">6.3.</span> <span class="toc-text">Emergency Notification</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Local-Fleet-Communication-with-ESP32"><span class="toc-number">7.</span> <span class="toc-text">Local Fleet Communication with ESP32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Architecture-Diagram-ASCII"><span class="toc-number">7.1.</span> <span class="toc-text">Architecture Diagram (ASCII)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-Send-a-Message-from-the-PC"><span class="toc-number">7.2.</span> <span class="toc-text">Example: Send a Message from the PC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-Listen-to-Incoming-Messages"><span class="toc-number">7.3.</span> <span class="toc-text">Example: Listen to Incoming Messages</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usual-Boring-Security-Considerations"><span class="toc-number">8.</span> <span class="toc-text">Usual Boring Security Considerations</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion-and-Future-Work"><span class="toc-number"></span> <span class="toc-text">Conclusion and Future Work</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://tokipona.today/2025/05/24/MQTT/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://tokipona.today/2025/05/24/MQTT/&text=MQTT Concepts for Iot project"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://tokipona.today/2025/05/24/MQTT/&title=MQTT Concepts for Iot project"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://tokipona.today/2025/05/24/MQTT/&is_video=false&description=MQTT Concepts for Iot project"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MQTT Concepts for Iot project&body=Check out this article: http://tokipona.today/2025/05/24/MQTT/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://tokipona.today/2025/05/24/MQTT/&title=MQTT Concepts for Iot project"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025
    jan Pitaki
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/tags/lesson">Lessons</a></li>
         
          <li><a href="/tags/practice">practice</a></li>
         
          <li><a href="/tags/blog">blog</a></li>
         
          <li><a href="/tags/other">other</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://tokipona.org">links</a></li>
         
          <li><a href="/About/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
